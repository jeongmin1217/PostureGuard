# Posture Guard

**거북목과 일자목의 지속적인 모니터링을 통한 척추 및 목 건강 지킴이**

사용자의 카메라를 활용한 실시간/일간/주간 자세 분석 및 기록 데스크탑 앱

## Problem Statements & Goal

현대인의 고질적인 노트북/컴퓨터 사용 중 척추 및 목 건강 문제 <br>
데스크탑 앱을 통해 실시간으로 사용자의 자세를 분석해 모니터링 하며, 분석 자료를 통해 지속적인 척추와 목 건강 관리가 가능하게끔 하는 것을 목표로 하여 문제를 해결하고자 함

## Project Overview

https://github.com/user-attachments/assets/cfb2e5e5-910f-43f9-8625-2170290d006a

<h3>[Description]</h3>
1. 준실시간(600ms) 데이터 분석을 통한 자세 모니터링<br>
2. 일일 배치 분석을 통해 저장되는 일일 자세 분석 자료<br>
3. 달력 기능을 통한 지속적인 척추 및 목 건강 관리<br>
4. 지난 일주일간의 평균 자세 분석 자료를 통한 지속적 관리

## Project Architecture

<img src="https://github.com/user-attachments/assets/e6bc5e2c-a6b3-4c69-aa00-ddeade70b727" align="center" style="width:50rem; height:auto;"></img>

## Main Problem Solving

1. 실시간 데이터 처리 병목 현상 해결

- 단일 파티션에 걸리던 과부화를 해결하기 위해, 수집한 데이터를 Kafka와 Spark Streaming의 병렬처리적 특성을 활용해 파티션 수를 6개로 설정, 병목 현상 해결

2. 분산 처리를 통한 성능 향상

- 오버헤드가 없으면서 최대 효율 성능을 내기 위한 적절한 Spark Executor 수(7개)와 Partition 수(390개)를 설정하여 분산 처리를 통한 성능 향상
- 1만개의 평균 45KB json 파일 처리 및 분석 작업을 42분 46초에서 35분 42초로 약 17% 단축

3. <b>데이터 분석에 필요한 데이터 집계 마트 개발 및 구축</b>

- <b>일주일 간의 분석 데이터를 제공하겠다는 분석 목적에 기반, </b>준실시간 데이터 분석을 통해 수집된 데이터를 일일 배치로 하루 평균의 이미지와 값을 분석해 BigQuery와 Google Cloud Storage에 저장하여 주간 데이터 분석을 효율적으로 진행하고자 함<br>
- 일주일간의 평균 기록을 BigQuery 데이터 집계 마트를 이용해 효율적 분석 진행

> ### Spark, Kafka Performance Comparison

> #### Spark : 1만개의 평균 45KB json 파일 처리 및 분석 작업 기준
>
> | 소요 시간                | <span style="color:red">35분 42초</span> | 42분 46초 | 41분 24초 |
> | ------------------------ | :--------------------------------------: | :-------: | :-------: |
> | **Executor 수**          |                    7                     |     7     |     3     |
> | **Executor 당 Core 수**  |                    4                     |     4     |     4     |
> | **Executor 할당 메모리** |                   11G                    |    11G    |    11G    |
> | **파티션 수**            |                  390개                   |   98개    |   390개   |

> #### Kafka : 16진수로 인코딩된 이미지 데이터와 timestamp가 담긴 json 파일 기준
>
> | 처리 지연 여부        |  O   |  O   | <span style="color:red">X</span> |
> | --------------------- | :--: | :--: | :------------------------------: |
> | **데이터 전송 시간**  | 50ms | 50ms |              600ms               |
> | **토픽 파티션 수**    |  6   |  20  |                6                 |
> | **노트북 CPU 사용량** | 35%  | 45%  |               23%                |
